<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CasaShop — Loja de Casas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root{
            --primary:#0b5ed7;
            --accent:#0dcaf0;
            --dark:#0f1724;
            --muted:#6b7280;
            --bg:#f8fafc;
            --card-shadow: 0 8px 24px rgba(11,94,215,0.08);
            --radius: 12px;
            --transition: 0.25s ease;
        }

        *{box-sizing:border-box}
        body{font-family:'Poppins',sans-serif;background:var(--bg);color:var(--dark);margin:0}
        a{color:var(--primary)}

        .navbar{background:rgba(255,255,255,.9);backdrop-filter:blur(6px);box-shadow:0 6px 18px rgba(2,6,23,0.04)}
        .brand{font-weight:700;color:var(--primary);letter-spacing:.4px}

        .hero{padding:6rem 0 4rem}
        .hero .lead{color:var(--muted)}

        .search-row{gap:1rem;margin-bottom:1.25rem}

        .card-house{border-radius:var(--radius);overflow:hidden;box-shadow:var(--card-shadow);transition:transform var(--transition)}
        .card-house:hover{transform:translateY(-6px)}
        .house-img{height:220px;background-size:cover;background-position:center}

        .tag{display:inline-block;padding:.25rem .6rem;border-radius:999px;background:rgba(11,94,215,0.08);color:var(--primary);font-weight:600;font-size:.8rem}

        .filters .btn{border-radius:999px}

        #mapPlaceholder{height:260px;background:linear-gradient(135deg,#e6f6ff,#f7fbff);border-radius:12px;display:flex;align-items:center;justify-content:center;color:var(--muted)}

        .quiz-card{border-radius:12px;padding:1.25rem;background:white;box-shadow:var(--card-shadow)}
        .option{cursor:pointer;padding:.75rem;border-radius:8px;border:1px solid transparent}
        .option:hover{background:#f8f9ff}
        .option.selected{border-color:var(--primary);background:rgba(11,94,215,0.05)}

        .footer{background:#07102a;color:#cbd5e1;padding:3rem 0;margin-top:3rem}

        @media(max-width:768px){.hero{padding:4rem 0}.house-img{height:180px}}
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand brand" href="#">CasaShop</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navmenu">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navmenu">
                <ul class="navbar-nav ms-auto align-items-lg-center">
                    <li class="nav-item"><a class="nav-link" href="#homes">Casas</a></li>
                    <li class="nav-item"><a class="nav-link" href="#quiz">Quiz</a></li>
                    <li class="nav-item"><a class="nav-link" href="#contact">Contacto</a></li>
                    <li class="nav-item ms-2 d-none d-lg-block"><a class="btn btn-outline-primary" href="#homes">Ver Casas</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <header class="hero">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="mb-3">Encontre a sua casa perfeita — rápida, segura e sem complicações</h1>
                    <p class="lead">CasaShop é uma loja de casas fictícia criada como trabalho escolar. Explore listagens, veja imagens em carrossel, faça perguntas com um quiz interativo e contacte-nos.</p>
                    <div class="mt-4">
                        <a href="#homes" class="btn btn-primary me-2">Explorar Casas</a>
                        <a href="#quiz" class="btn btn-outline-primary">Jogar Quiz</a>
                    </div>
                </div>
                <div class="col-lg-6 mt-4 mt-lg-0">
                    <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-indicators"></div>
                        <div class="carousel-inner rounded-4 overflow-hidden"></div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Anterior</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Próximo</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="py-5" id="homes">
            <div class="container">
                <div class="row mb-4 align-items-center">
                    <div class="col-md-8">
                        <h2>Casas Disponíveis</h2>
                        <p class="text-muted">Listei várias casas como objetos em JavaScript e apresento-as dinamicamente.</p>
                    </div>
                    <div class="col-md-4 text-md-end">
                        <button id="openFavorites" class="btn btn-outline-secondary me-2"><i class="fa-regular fa-heart"></i> Favoritos <span id="favCount" class="badge bg-primary ms-2">0</span></button>
                    </div>
                </div>

                <div class="row mb-3 search-row">
                    <div class="col-md-6 d-flex">
                        <input id="searchInput" class="form-control me-2" placeholder="Procurar por cidade, nome ou preço...">
                        <select id="sortSelect" class="form-select" style="max-width:160px">
                            <option value="default">Ordenar</option>
                            <option value="price-asc">Preço ↑</option>
                            <option value="price-desc">Preço ↓</option>
                            <option value="area-desc">Área ↓</option>
                        </select>
                    </div>
                    <div class="col-md-6 text-md-end filters">
                        <button class="btn btn-sm btn-outline-primary me-1" data-filter="all">Todos</button>
                        <button class="btn btn-sm btn-outline-primary me-1" data-filter="apartment">Apartamento</button>
                        <button class="btn btn-sm btn-outline-primary me-1" data-filter="house">Moradia</button>
                        <button class="btn btn-sm btn-outline-primary me-1" data-filter="villa">Moradia Luxo</button>
                    </div>
                </div>

                <div class="row" id="housesContainer"></div>

                <div class="row mt-5">
                    <div class="col-lg-8">
                        <h5>Localização</h5>
                        <div id="mapPlaceholder">Mapa interativo simulador (ex: Google Maps)</div>
                    </div>
                    <div class="col-lg-4">
                        <h5>Detalhes rápidos</h5>
                        <ul class="list-unstyled">
                            <li><strong>Casas listadas:</strong> <span id="totalHouses">0</span></li>
                            <li><strong>Mín. Preço:</strong> <span id="minPrice">—</span></li>
                            <li><strong>Máx. Preço:</strong> <span id="maxPrice">—</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-5 bg-white" id="quiz">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8">
                        <h2>Quiz Interativo: Teste os seus conhecimentos de JavaScript</h2>
                        <p class="text-muted">Um pequeno jogo tipo 'kahoot' para testar a matéria vista nas aulas.</p>

                        <div class="quiz-card mt-3" id="quizCard">
                            <div id="quizQuestionArea"></div>
                            <div class="mt-3 d-flex justify-content-between align-items-center">
                                <div><small id="quizProgress">Questão 1 / 1</small></div>
                                <div>
                                    <button id="nextBtn" class="btn btn-primary btn-sm">Próxima</button>
                                    <button id="restartBtn" class="btn btn-outline-secondary btn-sm">Recomeçar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 mt-4 mt-lg-0">
                        <h5>Pontuação</h5>
                        <div class="p-3 bg-light rounded-3 text-center">
                            <h3 id="score">0</h3>
                            <p class="mb-0 text-muted">Pontos</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-5" id="contact">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6">
                        <h2>Contacto</h2>
                        <p class="text-muted">Preencha o formulário para nos contactar. O CAPTCHA é gerado e validado em JavaScript.</p>

                        <div class="card p-4" style="border-radius:12px;box-shadow:var(--card-shadow)">
                            <form id="contactForm">
                                <div class="mb-3">
                                    <input id="name" class="form-control" placeholder="Nome" required>
                                </div>
                                <div class="mb-3">
                                    <input id="email" type="email" class="form-control" placeholder="Email" required>
                                </div>
                                <div class="mb-3">
                                    <textarea id="message" class="form-control" rows="4" placeholder="Mensagem" required></textarea>
                                </div>

                                <div class="d-flex align-items-center mb-3">
                                    <div id="captchaCode" class="me-3" style="font-family:monospace;background:#fff;padding:.5rem 1rem;border-radius:8px;border:1px solid #e6eefb">AB12CD</div>
                                    <button type="button" id="refreshCaptcha" class="btn btn-outline-secondary btn-sm me-3"><i class="fa-solid fa-rotate"></i></button>
                                    <input id="captchaInput" class="form-control" placeholder="Escreva o código" style="max-width:260px" required>
                                </div>

                                <div class="d-grid">
                                    <button class="btn btn-primary" type="submit">Enviar Mensagem</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="col-lg-6 mt-4 mt-lg-0">
                        <h5>Informações</h5>
                        <p class="text-muted">CasaShop — Loja de Casas (exemplo escolar). Endereço fictício.</p>
                        <ul class="list-unstyled">
                            <li><i class="fa-regular fa-envelope me-2"></i> contacto@casashop.example</li>
                            <li><i class="fa-solid fa-phone me-2"></i> +351 900 000 000</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container text-center">
            <p class="mb-0">&copy; 2025 CasaShop — Projeto Escolar. Todos os direitos reservados.</p>
        </div>
    </footer>

    <!-- Modal: House details + carousel -->
    <div class="modal fade" id="houseModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 id="modalTitle" class="modal-title">Casa</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="modalCarousel" class="carousel slide mb-3" data-bs-ride="carousel">
                        <div class="carousel-inner"></div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#modalCarousel" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#modalCarousel" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        </button>
                    </div>
                    <p id="modalDesc"></p>
                    <ul id="modalSpecs" class="list-unstyled"></ul>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline-secondary" id="favToggle"><i class="fa-regular fa-heart"></i> Favoritar</button>
                    <button class="btn btn-primary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const houses = [
            { id:1, title:'Moradia Solar', type:'house', city:'Porto', price:450000, area:220, images:[
                'https://images.unsplash.com/photo-1560185127-6c1d4b4b1d3a?auto=format&fit=crop&w=1470&q=80',
                'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?auto=format&fit=crop&w=1470&q=80'
            ], desc:'Moradia luminosa com grande jardim e painéis solares integrados.'},
            { id:2, title:'Apartamento Central', type:'apartment', city:'Lisboa', price:320000, area:95, images:[
                'https://images.unsplash.com/photo-1580587771525-78b9dba3b914?auto=format&fit=crop&w=1470&q=80'
            ], desc:'Apartamento moderno no centro da cidade, perto de transportes e comércio.'},
            { id:3, title:'Villa do Bosque', type:'villa', city:'Faro', price:980000, area:420, images:[
                'https://images.unsplash.com/photo-1505691723518-36a9c6fbe1aa?auto=format&fit=crop&w=1470&q=80',
                'https://images.unsplash.com/photo-1533099263-4a3a03c5f7f7?auto=format&fit=crop&w=1470&q=80',
                'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=1470&q=80'
            ], desc:'Villa de luxo com piscina e vistas sobre o bosque.'},
            { id:4, title:'T1 Acolhedor', type:'apartment', city:'Coimbra', price:145000, area:48, images:[
                'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=1470&q=80'
            ], desc:'Pequeno apartamento ideal para estudantes ou investidores.'}
        ];

        (function initHero(){
            const carousel = document.querySelector('#heroCarousel .carousel-inner');
            const indicators = document.querySelector('#heroCarousel .carousel-indicators');
            houses.slice(0,3).forEach((h,i)=>{
                const item = document.createElement('div');
                item.className = 'carousel-item'+(i===0? ' active':'');
                item.style.backgroundImage = `url(${h.images[0]})`;
                item.style.height = '320px';
                item.style.backgroundSize='cover';
                item.style.backgroundPosition='center';
                const caption = document.createElement('div');
                caption.className='carousel-caption d-none d-md-block bg-dark bg-opacity-25 rounded-3 p-3';
                caption.innerHTML = `<h5>${h.title}</h5><p class="mb-0">${h.city} — €${h.price.toLocaleString()}</p>`;
                item.appendChild(caption);
                carousel.appendChild(item);

                const btn = document.createElement('button');
                btn.type='button';
                if(i===0) btn.className='active';
                btn.setAttribute('data-bs-target','#heroCarousel');
                btn.setAttribute('data-bs-slide-to',String(i));
                indicators.appendChild(btn);
            });
        })();

        const housesContainer = document.getElementById('housesContainer');
        const totalHousesEl = document.getElementById('totalHouses');
        const minPriceEl = document.getElementById('minPrice');
        const maxPriceEl = document.getElementById('maxPrice');

        function renderHouses(list){
            housesContainer.innerHTML = '';
            list.forEach(h => {
                const col = document.createElement('div');
                col.className = 'col-md-6 col-lg-4 mb-4';
                col.innerHTML = `
                    <div class="card-house bg-white">
                        <div class="house-img" style="background-image:url('${h.images[0]}')"></div>
                        <div class="p-3">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <h5 class="mb-0">${h.title}</h5>
                                <span class="tag">${h.type}</span>
                            </div>
                            <p class="text-muted small mb-2">${h.city} — ${h.area} m²</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <strong>€${h.price.toLocaleString()}</strong>
                                <div>
                                    <button class="btn btn-sm btn-outline-primary me-1" data-id="${h.id}" data-action="details">Ver Detalhes</button>
                                    <button class="btn btn-sm btn-outline-secondary" data-id="${h.id}" data-action="fav"><i class="fa-regular fa-heart"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                housesContainer.appendChild(col);
            });
            totalHousesEl.textContent = list.length;
            const prices = list.map(x=>x.price);
            minPriceEl.textContent = prices.length? '€'+Math.min(...prices).toLocaleString(): '—';
            maxPriceEl.textContent = prices.length? '€'+Math.max(...prices).toLocaleString(): '—';
        }

        renderHouses(houses);

        document.querySelectorAll('.filters [data-filter]').forEach(btn=>{
            btn.addEventListener('click', ()=>{
                document.querySelectorAll('.filters [data-filter]').forEach(b=>b.classList.remove('active'));
                btn.classList.add('active');
                applyListState();
            });
        });

        document.getElementById('searchInput').addEventListener('input', applyListState);
        document.getElementById('sortSelect').addEventListener('change', applyListState);

        function applyListState(){
            const search = document.getElementById('searchInput').value.toLowerCase();
            const activeFilter = document.querySelector('.filters .active')?.getAttribute('data-filter') || 'all';
            let list = houses.filter(h => {
                if(activeFilter!=='all' && h.type!==activeFilter) return false;
                if(!search) return true;
                return h.title.toLowerCase().includes(search) || h.city.toLowerCase().includes(search) || String(h.price).includes(search);
            });
            const sort = document.getElementById('sortSelect').value;
            if(sort==='price-asc') list.sort((a,b)=>a.price-b.price);
            if(sort==='price-desc') list.sort((a,b)=>b.price-a.price);
            if(sort==='area-desc') list.sort((a,b)=>b.area-b.area);
            renderHouses(list);
        }

        const houseModal = new bootstrap.Modal(document.getElementById('houseModal'));
        document.body.addEventListener('click', (e)=>{
            const btn = e.target.closest('button');
            if(!btn) return;
            const id = btn.getAttribute('data-id');
            const action = btn.getAttribute('data-action');
            if(!id) return;
            const h = houses.find(x=>String(x.id)===id);
            if(action==='details') openDetails(h);
            if(action==='fav') toggleFav(h,btn);
        });

        let favorites = JSON.parse(localStorage.getItem('favHouses')||'[]');
        function updateFavCount(){document.getElementById('favCount').textContent = favorites.length}
        updateFavCount();

        function toggleFav(h,btn){
            const idx = favorites.indexOf(h.id);
            if(idx===-1) favorites.push(h.id); else favorites.splice(idx,1);
            localStorage.setItem('favHouses',JSON.stringify(favorites));
            updateFavCount();
            btn.querySelector('i')?.classList.toggle('fa-solid');
        }

        function openDetails(h){
            document.getElementById('modalTitle').textContent = h.title+' — '+h.city;
            document.getElementById('modalDesc').textContent = h.desc;
            const specs = document.getElementById('modalSpecs'); specs.innerHTML = '';
            specs.innerHTML = `<li>Preço: €${h.price.toLocaleString()}</li><li>Área: ${h.area} m²</li><li>Tipo: ${h.type}</li>`;
            const inner = document.querySelector('#modalCarousel .carousel-inner'); inner.innerHTML='';
            h.images.forEach((src,i)=>{
                const it = document.createElement('div'); it.className='carousel-item'+(i===0?' active':'');
                it.innerHTML = `<img src="${src}" class="d-block w-100" style="height:360px;object-fit:cover">`;
                inner.appendChild(it);
            });
            houseModal.show();
        }

        document.getElementById('openFavorites').addEventListener('click', ()=>{
            const list = houses.filter(h=>favorites.includes(h.id));
            if(!list.length) return alert('Nenhum favorito.');
            renderHouses(list);
            window.location.href = '#homes';
        });

        function genCaptcha(){
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            let out=''; for(let i=0;i<6;i++) out+=chars.charAt(Math.floor(Math.random()*chars.length));
            return out;
        }
        let currentCaptcha = genCaptcha();
        document.getElementById('captchaCode').textContent = currentCaptcha;
        document.getElementById('refreshCaptcha').addEventListener('click', ()=>{
            currentCaptcha = genCaptcha(); document.getElementById('captchaCode').textContent = currentCaptcha;
        });

        document.getElementById('contactForm').addEventListener('submit', function(e){
            e.preventDefault();
            const val = document.getElementById('captchaInput').value.trim();
            if(val!==currentCaptcha){ alert('CAPTCHA incorreto. Tente novamente.'); currentCaptcha = genCaptcha(); document.getElementById('captchaCode').textContent = currentCaptcha; return; }
            alert('Mensagem enviada (simulação). Obrigado!');
            this.reset(); currentCaptcha = genCaptcha(); document.getElementById('captchaCode').textContent = currentCaptcha;
        });

        const quizQuestions = [
            {q:'O que faz o operador === em JavaScript?', options:['Apenas comparação de valor','Comparação de valor e tipo','Atribuição','Nada'], a:1},
            {q:'Como declaras uma função em ES6 com arrow?', options:['function fn() {}','const fn = () => {}','let fn := {}','fn => {}'], a:1},
            {q:'Qual método converte um objeto em JSON string?', options:['JSON.parse','JSON.stringify','toString','Object.toJSON'], a:1}
        ];

        let quizState = { index:0, score:0, answers:[] };

        function showQuestion(){
            const area = document.getElementById('quizQuestionArea'); area.innerHTML='';
            const q = quizQuestions[quizState.index];
            const h = document.createElement('h5'); h.textContent = q.q; area.appendChild(h);
            const list = document.createElement('div'); list.className = 'mt-3';
            q.options.forEach((opt,i)=>{
                const div = document.createElement('div'); div.className='option mb-2'; div.textContent = opt; div.dataset.idx=i;
                div.addEventListener('click', ()=>{
                    document.querySelectorAll('.option').forEach(o=>o.classList.remove('selected'));
                    div.classList.add('selected');
                    quizState.selected = i;
                });
                list.appendChild(div);
            });
            area.appendChild(list);
            document.getElementById('quizProgress').textContent = `Questão ${quizState.index+1} / ${quizQuestions.length}`;
            document.getElementById('score').textContent = quizState.score;
        }

        document.getElementById('nextBtn').addEventListener('click', ()=>{
            const s = quizState.selected;
            if(typeof s==='undefined') return alert('Escolha uma opção.');
            const correct = quizQuestions[quizState.index].a;
            if(s===correct) quizState.score += 10;
            quizState.answers.push({q:quizState.index, selected:s, correct});
            quizState.index++;
            delete quizState.selected;
            if(quizState.index >= quizQuestions.length){
                alert('Quiz terminado! Pontuação: ' + quizState.score);
                document.getElementById('score').textContent = quizState.score;
            } else showQuestion();
        });

        document.getElementById('restartBtn').addEventListener('click', ()=>{quizState = {index:0,score:0,answers:[]}; showQuestion();});

        document.addEventListener('DOMContentLoaded', ()=>{ renderHouses(houses); showQuestion(); });
    </script>
</body>
</html>